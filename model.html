<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Regression model</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.6.3/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Introduction.html">Introduction</a>
</li>
<li>
  <a href="Data.html">Data Sources</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Analysis
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="EDA.html">Exploratory Analysis</a>
    </li>
    <li>
      <a href="EDA.html">Statistical Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a>
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/MiaYum/Alzheimers_Disease_New_Hope">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Regression model</h1>

</div>


<div id="data-set-splitting" class="section level1">
<h1>Data Set Splitting</h1>
<p>We used data from the years 2018 to 2020 as our training set, and
data from 2021 as our test set.</p>
<p>All these datasets have been filtered to remove any missing values
and do not contain any outliers, ensuring that the data quality is high.
This preprocessing step lays a strong foundation for building accurate
and reliable models.</p>
<pre class="r"><code>data=readRDS(&quot;data_for_model.rds&quot;) 
training_data &lt;- filter(data, year &gt;= 2018 &amp; year &lt;= 2020)|&gt;select(-c(state,year))
testing_data &lt;- filter(data, year == 2021)|&gt;select(-c(state,year))</code></pre>
</div>
<div id="multiple-linear-regression" class="section level1">
<h1>Multiple Linear Regression</h1>
<div id="model-selection" class="section level2">
<h2>Model Selection</h2>
<p>The primary reason for initially choosing linear models in
statistical analysis is their simplicity and ease of understanding.
These models, by representing relationships in a straightforward linear
manner, make it easier for us to comprehend how different variables
interact with each other.</p>
<p>Moreover, linear models are known for their robustness, offering
reliable performance even with various types of data and statistical
errors. Importantly, they serve as an effective benchmark in more
complex modeling processes.</p>
<p>By starting with a linear model, we can establish a baseline
performance level, against which the effectiveness of more sophisticated
models can be measured. This stepwise approach helps in ensuring that
the complexity of a model is justified by a significant improvement over
the simpler linear model.</p>
</div>
<div id="full-model-linear-regression" class="section level2">
<h2>Full model-Linear regression</h2>
<pre class="r"><code>model &lt;- lm(death_rate ~ employment + hc_exp + income + edu_level + cardio_rate + smoke_rate + elder_rate, data = training_data)
summary(model) |&gt; 
broom::tidy() |&gt;
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">68.3037142</td>
<td align="right">13.4233735</td>
<td align="right">5.0884164</td>
<td align="right">0.0000012</td>
</tr>
<tr class="even">
<td align="left">employment</td>
<td align="right">24.9223618</td>
<td align="right">16.5331015</td>
<td align="right">1.5074221</td>
<td align="right">0.1340921</td>
</tr>
<tr class="odd">
<td align="left">hc_exp</td>
<td align="right">-0.0012826</td>
<td align="right">0.0007332</td>
<td align="right">-1.7492692</td>
<td align="right">0.0825687</td>
</tr>
<tr class="even">
<td align="left">income</td>
<td align="right">-0.0002319</td>
<td align="right">0.0001776</td>
<td align="right">-1.3061814</td>
<td align="right">0.1937624</td>
</tr>
<tr class="odd">
<td align="left">edu_level</td>
<td align="right">-45.7011712</td>
<td align="right">21.4826355</td>
<td align="right">-2.1273540</td>
<td align="right">0.0352503</td>
</tr>
<tr class="even">
<td align="left">cardio_rate</td>
<td align="right">180.2845378</td>
<td align="right">51.4160324</td>
<td align="right">3.5063876</td>
<td align="right">0.0006212</td>
</tr>
<tr class="odd">
<td align="left">smoke_rate</td>
<td align="right">-11.4113239</td>
<td align="right">31.4644509</td>
<td align="right">-0.3626735</td>
<td align="right">0.7174288</td>
</tr>
<tr class="even">
<td align="left">elder_rate</td>
<td align="right">-152.9455140</td>
<td align="right">35.4789569</td>
<td align="right">-4.3108797</td>
<td align="right">0.0000316</td>
</tr>
</tbody>
</table>
<pre class="r"><code>broom::glance(model) |&gt;
  mutate(model = &quot;Full Linear Regression&quot;) |&gt;
  select(model, r.squared, adj.r.squared, p.value, AIC, BIC) |&gt;
  knitr::kable()</code></pre>
<table>
<colgroup>
<col width="31%" />
<col width="13%" />
<col width="19%" />
<col width="10%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="right">r.squared</th>
<th align="right">adj.r.squared</th>
<th align="right">p.value</th>
<th align="right">AIC</th>
<th align="right">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Full Linear Regression</td>
<td align="right">0.3990315</td>
<td align="right">0.367162</td>
<td align="right">0</td>
<td align="right">956.2865</td>
<td align="right">982.7613</td>
</tr>
</tbody>
</table>
</div>
<div id="backwards-elimination" class="section level2">
<h2>Backwards Elimination</h2>
<p>We use Backward Elimination for constructing our linear regression
model to enhance its efficiency and interpretability. This method
systematically removes the least significant variables, ensuring that
only the most impactful predictors are retained. Consequently, it helps
in reducing model complexity and avoiding overfitting, resulting in a
more robust and meaningful model.</p>
<pre class="r"><code>backward_result = step(model, direction = &#39;backward&#39;, trace = 0)
  broom::tidy(backward_result) |&gt;
      knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">74.2170216</td>
<td align="right">7.6615066</td>
<td align="right">9.687001</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">hc_exp</td>
<td align="right">-0.0014021</td>
<td align="right">0.0005712</td>
<td align="right">-2.454649</td>
<td align="right">0.0153748</td>
</tr>
<tr class="odd">
<td align="left">edu_level</td>
<td align="right">-47.8686408</td>
<td align="right">12.8765984</td>
<td align="right">-3.717491</td>
<td align="right">0.0002939</td>
</tr>
<tr class="even">
<td align="left">cardio_rate</td>
<td align="right">146.1913832</td>
<td align="right">46.7572070</td>
<td align="right">3.126606</td>
<td align="right">0.0021660</td>
</tr>
<tr class="odd">
<td align="left">elder_rate</td>
<td align="right">-155.1015760</td>
<td align="right">33.8923959</td>
<td align="right">-4.576294</td>
<td align="right">0.0000106</td>
</tr>
</tbody>
</table>
</div>
<div id="selected-value" class="section level2">
<h2>Selected value</h2>
<pre class="r"><code>selected_model &lt;- lm(death_rate ~ hc_exp + edu_level + cardio_rate + elder_rate, data = training_data)
summary(selected_model)</code></pre>
<pre><code>## 
## Call:
## lm(formula = death_rate ~ hc_exp + edu_level + cardio_rate + 
##     elder_rate, data = training_data)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -16.9062  -4.7205   0.8188   5.0059  16.3380 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  7.422e+01  7.662e+00   9.687  &lt; 2e-16 ***
## hc_exp      -1.402e-03  5.712e-04  -2.455 0.015375 *  
## edu_level   -4.787e+01  1.288e+01  -3.717 0.000294 ***
## cardio_rate  1.462e+02  4.676e+01   3.127 0.002166 ** 
## elder_rate  -1.551e+02  3.389e+01  -4.576 1.06e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 7.11 on 135 degrees of freedom
## Multiple R-squared:  0.3854, Adjusted R-squared:  0.3672 
## F-statistic: 21.17 on 4 and 135 DF,  p-value: 1.448e-13</code></pre>
<pre class="r"><code>residuals &lt;- resid(selected_model)

qqnorm(residuals)
qqline(residuals, col = &quot;red&quot;)</code></pre>
<p><img src="model_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="model-performation" class="section level2">
<h2>Model Performation</h2>
<div id="cross-validation-for-rmse" class="section level3">
<h3>Cross Validation for RMSE</h3>
<pre class="r"><code>library(modelr)
# generate a cv dataframe 
cv_df &lt;-
  crossv_mc(training_data, 100) %&gt;% 
  mutate(
    train = map(train, as_tibble),
    test = map(test, as_tibble))
# fit the model to the generated CV dataframe
cv_df &lt;-
  cv_df %&gt;% 
  mutate(
    model  = map(train, ~lm(death_rate ~employment+hc_exp+income+edu_level+cardio_rate+smoke_rate+elder_rate, data = .x)),
    rmse = map2_dbl(model, test, ~rmse(model = .x, data = .y)))
# plot the prediction error
cv_df %&gt;% 
  select(rmse) %&gt;% 
  pivot_longer(
    everything(),
    names_to = &quot;model&quot;, 
    values_to = &quot;rmse&quot;) %&gt;% 
  ggplot(aes(x= model, y = rmse)) + 
  geom_violin() +
  labs(
    title = &quot;Prediction Errors For Our Model Under CV&quot;,
    x = &quot;Model lm&quot;,
    y = &quot;Prediction Errors&quot;
  ) </code></pre>
<p><img src="model_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>加入bootstrap</p>
</div>
</div>
</div>
<div id="random-forest-model" class="section level1">
<h1>Random Forest Model</h1>
<div id="model-selection-1" class="section level2">
<h2>Model Selection</h2>
<p>Justify the choice of the random forest model. Explain the
fundamental principles of the model.</p>
<pre class="r"><code>library(randomForest)</code></pre>
<pre><code>## Warning: package &#39;randomForest&#39; was built under R version 4.3.2</code></pre>
<pre><code>## randomForest 4.7-1.1</code></pre>
<pre><code>## Type rfNews() to see new features/changes/bug fixes.</code></pre>
<pre><code>## 
## Attaching package: &#39;randomForest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     margin</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<pre class="r"><code>rf_model &lt;- randomForest(death_rate ~employment+hc_exp+income+edu_level+cardio_rate+smoke_rate+elder_rate, data = training_data)</code></pre>
</div>
<div id="model-performation-1" class="section level2">
<h2>Model Performation</h2>
<pre class="r"><code>library(modelr)
# generate a cv dataframe 
cv_df &lt;-
  crossv_mc(training_data, 100) %&gt;% 
  mutate(
    train = map(train, as_tibble),
    test = map(test, as_tibble))
# fit the model to the generated CV dataframe
cv_df &lt;-
  cv_df %&gt;% 
  mutate(
    model  = map(train, ~randomForest(death_rate ~employment+hc_exp+income+edu_level+cardio_rate+smoke_rate+elder_rate, data = .x)),
    rmse = map2_dbl(model, test, ~rmse(model = .x, data = .y)))
# plot the prediction error
cv_df %&gt;% 
  select(rmse) %&gt;% 
  pivot_longer(
    everything(),
    names_to = &quot;model&quot;, 
    values_to = &quot;rmse&quot;) %&gt;% 
  ggplot(aes(x= model, y = rmse)) + 
  geom_violin() +
  labs(
    title = &quot;Prediction Errors For Our Model Under CV&quot;,
    x = &quot;Model rf&quot;,
    y = &quot;Prediction Errors&quot;
  ) </code></pre>
<p><img src="model_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code># R²
rf_predictions &lt;- predict(rf_model, training_data)
r_squared &lt;- cor(training_data$death_rate, rf_predictions)^2
print(paste(&quot;R²:&quot;, r_squared))</code></pre>
<pre><code>## [1] &quot;R²: 0.933748094846049&quot;</code></pre>
<pre class="r"><code>library(randomForest)
library(boot)</code></pre>
<pre><code>## 
## Attaching package: &#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lattice&#39;:
## 
##     melanoma</code></pre>
<pre class="r"><code># 假设 your_data 是您的数据集
# 假设响应变量是 target

# 自举函数
bootstrap_r2 &lt;- function(data, indices) {
  boot_data &lt;- data[indices, ]
  # 训练随机森林模型
  model &lt;- randomForest(death_rate ~employment+hc_exp+income+edu_level+cardio_rate+smoke_rate+elder_rate, data = boot_data)
  # 预测
  predictions &lt;- predict(model, boot_data)
  # 计算R²值
  r_squared &lt;- cor(boot_data$death_rate, predictions)^2
  return(r_squared)
}

# 执行自举
set.seed(123)  # 为了可重复性
results &lt;- boot(data = training_data, statistic = bootstrap_r2, R = 10)

# 绘制R²分布
hist(results$t, breaks = 30, main = &quot;Bootstrap Distribution of R²&quot;, xlab = &quot;R² Values&quot;)</code></pre>
<p><img src="model_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="prediction" class="section level2">
<h2>Prediction</h2>
<pre class="r"><code># Assuming you have actual_values, predicted_values_lm, and predicted_values_rf

# Create a scatter plot
plot(testing_data$death_rate, predict(rf_model, testing_data), main = &quot;Linear Regression Predictions&quot;, xlab = &quot;Actual Values&quot;, ylab = &quot;Predicted Values&quot;, col = &quot;black&quot;)</code></pre>
<p><img src="model_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="results-and-discussion" class="section level2">
<h2>Results and Discussion</h2>
<pre class="r"><code>importance_values &lt;- importance(rf_model)


print(importance_values)</code></pre>
<pre><code>##             IncNodePurity
## employment       1387.829
## hc_exp           1779.170
## income           1182.098
## edu_level        1880.600
## cardio_rate      1141.621
## smoke_rate       1557.432
## elder_rate       1523.054</code></pre>
<pre class="r"><code>library(plotly)</code></pre>
<pre><code>## 
## Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout</code></pre>
<pre class="r"><code>importance_values &lt;- importance(rf_model)

feature_importance &lt;- data.frame(Feature = rownames(importance_values), 
                                 Importance = importance_values[,1]) %&gt;%
  arrange(Importance) %&gt;% 
  mutate(Feature = factor(Feature, levels = Feature)) 

plot_ly(feature_importance, x = ~Importance, y = ~Feature, type = &#39;bar&#39;, orientation = &#39;h&#39;) %&gt;%
  layout(title = &quot;Feature Importance from Random Forest Model&quot;,
         xaxis = list(title = &quot;Importance&quot;),
         yaxis = list(title = &quot;Feature&quot;))</code></pre>
<div class="plotly html-widget html-fill-item" id="htmlwidget-9f83ddb664a7353a4f3f" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-9f83ddb664a7353a4f3f">{"x":{"visdat":{"593448ca7aa9":["function () ","plotlyVisDat"]},"cur_data":"593448ca7aa9","attrs":{"593448ca7aa9":{"x":{},"y":{},"orientation":"h","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Feature Importance from Random Forest Model","xaxis":{"domain":[0,1],"automargin":true,"title":"Importance"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Feature","type":"category","categoryorder":"array","categoryarray":["cardio_rate","income","employment","elder_rate","smoke_rate","hc_exp","edu_level"]},"hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1141.620816835476,1182.0978619725192,1387.8287322088379,1523.0538128295871,1557.4315047003458,1779.17033902448,1880.5998502382799],"y":["cardio_rate","income","employment","elder_rate","smoke_rate","hc_exp","edu_level"],"orientation":"h","type":"bar","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>数值较高的特征被视为更重要，diabetes_rate，rpp，obesity_rate 最重要 -
待解释</p>
<p>Summarize the performance of multiple linear regression and random
forest models.</p>
<p>Interpret model results and important features. Discuss limitations
of the study and future work.</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
